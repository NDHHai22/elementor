/* Angie Sidebar - CSS Variables */
:root {
    --angie-sidebar-z-index: 1200; /* below MUI popups, elementor popups and media library modal */
    --angie-sidebar-width: 330px;
    --angie-sidebar-transition: margin 0.3s ease-in-out, transform 0.3s ease-in-out;
    /* Direction-aware transform values for sidebar positioning */
    --angie-sidebar-hide-transform: translateX(-100%); /* LTR: hide to the left */
    --angie-sidebar-show-transform: translateX(0);
}

/* RTL-specific transform values */
[dir="rtl"] {
    --angie-sidebar-hide-transform: translateX(100%); /* RTL: hide to the right */
}

body.admin-bar {
    --angie-sidebar-z-index: 99999; /* above WP admin bar */
}
/* Respect user's motion preferences */
@media (prefers-reduced-motion: reduce) {
    :root {
        --angie-sidebar-transition: none;
    }
}

#angie-body-top-padding {
    height: 0;
    transition: height 0.3s ease-in-out;
}

/* Apply transitions only when user is actively toggling */
body.angie-sidebar-transitioning {
    transition: var(--angie-sidebar-transition) !important;
}

body.angie-sidebar-transitioning #wpadminbar {
    transition: var(--angie-sidebar-transition) !important;
}

body.angie-sidebar-transitioning #angie-sidebar-container {
    transition: var(--angie-sidebar-transition) !important;
}

/* LTR Layout (default) - Push content to the right */
@media (min-width: 768px) {
    body.angie-sidebar-active {
        padding-inline-start: var(--angie-sidebar-width) !important;
    }

    body.angie-sidebar-active #angie-body-top-padding {
        width: 100%;
        height: 8px;
    }

    /* Push WordPress Admin Bar - LTR */
    body.angie-sidebar-active #wpadminbar {
        inset-inline-start: var(--angie-sidebar-width) !important;
        inset-inline-end: 8px !important;
        width: calc(100% - 8px - var(--angie-sidebar-width)) !important;
        margin-top: 8px;
    }

    /* Sidebar container - LTR */
    #angie-sidebar-container {
        position: fixed;
        top: 0;
        inset-inline-start: 0;
        width: var(--angie-sidebar-width);
        height: 100vh;
        z-index: var(--angie-sidebar-z-index) !important; /* below elementor popups and media library modal */
        background: #FCFCFC;
        transform: var(--angie-sidebar-hide-transform);
        outline: none;
        overflow: hidden;
        /* No default transition - only when transitioning */
    }

    /* Resize handle */
    #angie-sidebar-container::after {
        content: '';
        position: absolute;
        top: 0;
        inset-inline-end: 0;
        width: 4px;
        height: 100%;
        cursor: ew-resize;
        background: transparent;
        z-index: 1000001;
    }

    /* Pink border during resize */
    #angie-sidebar-container.angie-resizing {
        border-inline-end-color: #ff69b4 !important;
        border-inline-end-width: 2px !important;
    }

    /* Disable iframe pointer events during resize */
    #angie-sidebar-container.angie-resizing iframe#editor-static-iframe {
        pointer-events: none !important;
    }

    body.angie-sidebar-active #wpfooter {
        bottom: 8px !important;
    }

    body.angie-sidebar-active #adminmenuback {
        top: 8px !important;
    }

    html.angie-sidebar-active {
        margin-inline-end: 8px !important;
    }

    body.angie-sidebar-active #adminmenuwrap {
        margin-bottom: 8px;
    }

    body.angie-sidebar-active #angie-wrapper {
        --angie-wrapper-border-width: 1px;
        position: fixed;
        top: 8px;
        inset-inline-start: var(--angie-sidebar-width);
        width: calc(100% - 7px - (var(--angie-wrapper-border-width) * 2) - var(--angie-sidebar-width));
        height: calc(100% - 17px);
        z-index: var(--angie-sidebar-z-index) !important;
        border: var(--angie-wrapper-border-width) solid var(--action-selected, rgba(0, 0, 0, 0.08));
        border-radius: 8px;
        box-shadow: 0 0 0 100vmax #FCFCFC;
        pointer-events: none;
    }


    body.angie-sidebar-active .woocommerce-layout__header{
        margin-top: 8px;
    }

    body.angie-sidebar-active #image-optimization-top-bar > div {
        width: 100% !important;
    }
    
    body.angie-sidebar-active .theme-wrap {
        z-index: var(--angie-sidebar-z-index) !important;
        width: calc(100% - var(--angie-sidebar-width)) !important;
    }
    
    body.angie-sidebar-active .e-global__popover {
        z-index: 1201 !important;
    }
    
    body.angie-sidebar-active #site-editor {
       margin-inline-start: var(--angie-sidebar-width) !important;
    }
}


/* Active states */
body.angie-sidebar-active #angie-sidebar-container {
    transform: var(--angie-sidebar-show-transform);
}

/* Studio mode - sidebar takes full width */
@media (min-width: 768px) {
    html.angie-studio-active body.angie-sidebar-active #angie-sidebar-container {
        width: 100%;
    }
}

/* WordPress Editor Fullscreen Mode Adjustments */
body {
    --admin-menu-width: 160px;
}

body.folded {
    --admin-menu-width: 36px;
}

body.is-fullscreen-mode {
    --admin-menu-width: 0px;
}

body.block-editor-page.angie-sidebar-active.block-editor-page .interface-interface-skeleton {
    inset-inline-start: calc(var(--angie-sidebar-width) + var(--admin-menu-width)) !important;
    inset-inline-end: 0 !important;
    top: calc(32px + 8px) !important;
    margin-bottom: 8px !important;
}

.block-editor-page.angie-sidebar-active.block-editor-page.is-fullscreen-mode .interface-interface-skeleton {
    top: 8px !important;
}

/* Ensure interface skeleton transitions smoothly */
body.block-editor-page.angie-sidebar-transitioning .interface-interface-skeleton {
    transition: var(--angie-sidebar-transition) !important;
}

body.angie-sidebar-active iframe.elementor-app-iframe {
    width: calc(100% - var(--angie-sidebar-width)) !important;
    margin-inline-start: var(--angie-sidebar-width);
}

/* High contrast mode support */
@media (prefers-contrast: high) {
    #angie-sidebar-container {
        border-color: #000;
        box-shadow: none;
    }
}

/* Screen reader only class */
.angie-sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* Mobile responsive behavior */
@media (max-width: 768px) {
    #angie-sidebar-container {
        display: none;
    }

    body.angie-sidebar-active {
        padding-inline-start: 0 !important;
        padding-inline-end: 0 !important;
    }

    body.angie-sidebar-active #wpadminbar{
        inset-inline-start: 0 !important;
        inset-inline-end: 0 !important;
        width: 100% !important;
    }

    /* Reset fullscreen mode adjustments on mobile */
    body.angie-sidebar-active .interface-interface-skeleton{
        inset-inline-start: 0 !important;
        inset-inline-end: 0 !important;
    }
}

/* Plugin conflict resolution */
body.angie-sidebar-active {
    /* Reset common conflicting styles */
    box-sizing: border-box !important;
    position: relative !important;
}

/* not in admin add a pixel margin top 3px - apply consistently */
body:not(.wp-admin) #angie-sidebar-container {
    margin-top: 3px;
}

#angie-sidebar-toggle {
    z-index: 99999 !important;
}
